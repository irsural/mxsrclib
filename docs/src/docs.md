# mxsrclib

В проекте [mxsrclib](https://okr.irsural.ru/git/okr/mxsrclib) находится cmake
файл для сборки.

В директории **convert_mxsrclib_headers** находится cmake файл с конвертацией заголовков
проекта [mxsrclib](https://okr.irsural.ru/git/okr/mxsrclib).

## Использование

Для использования mxsrclib проекта необходимо:

- Скопировать файл **irsconfig0.h**
  в клиентский проект, при необходимости редактировать и переименовать в **irsconfig.h**.

- В cmake файле клиентского проекта определить переменную ```IRSCONFIG_DIR```,
  в которую записать путь до директории, в которой находится ```irsconfig.h```.

- При сборке для микроконтроллеров добавить необходимые define'ы с помощью
  ```add_definitions```

- Подключить поддиректорию с mxsrclib.
  Сделать это можно с помощью
  ```add_subdirectory(${Путь до директории mxsrclib})```.

- Также желательно добавить зависимость клиентскому проекту с помощью
  ```add_dependencies(${Имя клиентского проекта} mxsrclib)```,
  чтобы убедиться, что конвертация заголовков произойдет до подключения их в проект
  (про конвертацию написано далее).

- При сборке для arm может потребоваться подключить файлы проекта
  [STM32CUBE](https://okr.irsural.ru/git/third_party_mirrors/STM32CubeF7)
  (проект для stm32f7).

  Создается таргет для **stm32cube** проекта и подключается в главном cmake файле в
  **mxsrclib** проекте с помощью ```target_link_libraries```.

- Установить необходимые переменные.

## Переменные

### Обязательные

- **MXSRCLIB_ARCH**

  Имя директории, в которой необходимо конвертировать заголовки
  помимо основных.

  Может принимать значение имени директории, находящейся в [этой директории
  ](https://okr.irsural.ru/git/okr/mxsrclib/src/branch/master/arch).

  Является обязательным к объявлению при необходимости использования файлов
  из директории **arch**.

  Стандартное значение: **none**

- **MXSRCLIB_CONVERT_SYMBOL_ENCODING**

  Принимает
  [любое доступное значение утилиты **iconv**](https://gist.github.com/hakre/4188459).

  Стандартного значения нет.

- **CMAKE_CXX_COMPILER**

  C++ компилятор.

  Стандартного значения нет.

- **IRSCONFIG_DIR**

  Путь до директории, в которой находится файл **irsconfig.h**.

  Стандартного значения нет.

### Необязательные

- **VERBOSE**

  Режим подробного вывода дополнительной информации.

  Стандартное значение: **True**


